@model IEnumerable<TrabalhoElvis2.Models.Condomino>

@{
    ViewData["Title"] = "Gestão de Condôminos";
    Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
    var tipoAtual = ViewBag.TipoAtual as string ?? "Proprietario";
}

<div class="container-fluid mt-4 mb-5">
    <!-- Cabeçalho -->
    <div class="d-flex justify-content-between align-items-center flex-wrap mb-4">
        <div>
            <h3 class="fw-semibold text-dark mb-0"><i class="fa-solid fa-users text-primary me-2"></i>Gestão de Condôminos</h3>
            <p class="text-muted mb-0">Gerencie proprietários, locatários e funcionários do condomínio.</p>
        </div>
        <button class="btn btn-primary shadow-sm mt-3 mt-md-0" data-bs-toggle="modal" data-bs-target="#modalCondomino">
            <i class="fa-solid fa-user-plus me-1"></i> Novo Condômino
        </button>
    </div>

    <!-- Cards de resumo -->
    <div class="row g-3 mb-4">
        <div class="col-md-4 col-sm-6">
            <div class="card resumo shadow-sm border-0 p-3">
                <div class="d-flex align-items-center">
                    <div class="icon bg-primary-subtle text-primary me-3">
                        <i class="fa-solid fa-user-tie"></i>
                    </div>
                    <div>
                        <small class="text-muted">Proprietários</small>
                        <h5 class="fw-bold mb-0">@Model.Count(c => c.Tipo == "Proprietario")</h5>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4 col-sm-6">
            <div class="card resumo shadow-sm border-0 p-3">
                <div class="d-flex align-items-center">
                    <div class="icon bg-success-subtle text-success me-3">
                        <i class="fa-solid fa-key"></i>
                    </div>
                    <div>
                        <small class="text-muted">Locatários</small>
                        <h5 class="fw-bold mb-0">@Model.Count(c => c.Tipo == "Locatario")</h5>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4 col-sm-6">
            <div class="card resumo shadow-sm border-0 p-3">
                <div class="d-flex align-items-center">
                    <div class="icon bg-warning-subtle text-warning me-3">
                        <i class="fa-solid fa-briefcase"></i>
                    </div>
                    <div>
                        <small class="text-muted">Funcionários</small>
                        <h5 class="fw-bold mb-0">@Model.Count(c => c.Tipo == "Funcionario")</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Barra de busca -->
    <div class="card border-0 shadow-sm p-3 mb-4">
        <div class="d-flex flex-wrap align-items-center justify-content-between">
            <div class="search-box flex-grow-1 me-2 mb-2 mb-md-0">
                <input type="text" class="form-control" placeholder="Buscar por nome, tipo ou CPF...">
            </div>
            <select class="form-select w-auto">
                <option>Todos os Tipos</option>
                <option>Proprietário</option>
                <option>Locatário</option>
                <option>Funcionário</option>
            </select>
        </div>
    </div>

    <!-- Lista -->
    <div class="card border-0 shadow-sm p-3">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-secondary mb-0">Lista de Condôminos (@Model.Count())</h6>
        </div>

        <div class="table-responsive">
            <table class="table align-middle mb-0">
                <thead class="text-muted small">
                    <tr>
                        <th>Nome</th>
                        <th>Tipo</th>
                        <th>Telefone</th>
                        <th>Email</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var c in Model)
                    {
                        <tr>
                            <td><i class="fa-regular fa-user text-primary me-2"></i>@c.NomeCompleto</td>
                            <td>@c.Tipo</td>
                            <td>@c.Telefone</td>
                            <td>@c.Email</td>
                            <td>
                                <span class="badge @(c.Tipo == "Funcionario" ? "bg-info text-white" :
                                                    c.Tipo == "Locatario" ? "bg-success text-white" :
                                                    "bg-dark text-white")">
                                    @c.Tipo
                                </span>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="modalCondomino" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title fw-semibold">Cadastrar Novo Condômino</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <form asp-action="Cadastrar" method="post">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Tipo</label>
                            <select id="Tipo" name="Tipo" class="form-select" required>
                                <option value="">Selecione...</option>
                                <option value="Proprietario">Proprietário</option>
                                <option value="Locatario">Locatário</option>
                                <option value="Funcionario">Funcionário</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Nome Completo</label>
                            <input type="text" name="NomeCompleto" class="form-control" required />
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">E-mail</label>
                            <input type="email" name="Email" class="form-control" />
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Telefone</label>
                            <input type="text" name="Telefone" class="form-control" />
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">CPF</label>
                            <input type="text" name="CPF" class="form-control" />
                        </div>
                    </div>

                    <div class="text-end mt-4">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
